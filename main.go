package main

import (
	"fmt"
	"log"
	"os"
)

func main() {
	cveData, err := os.ReadFile("db.json")
	if err != nil {
		log.Fatal(err)
		return
	}

	apps := []Application{ // FIXME: read from file
		{
			Vendor: "winrar",
			VendorAliases: []string{
				"win-rar",
				"rarlab",
			},
			Name:    "winrar",
			Version: "6.9",
		},
	}

	cpeSpec := "2.3"
	cve, err := NewCVE(cveData)
	if err != nil {
		log.Fatal(err)
		return
	}

	vs := NewVulnerabilitySearch(*cve, cpeSpec)

	vulnerableApps := vs.Search(apps)
	for _, app := range vulnerableApps {
		fmt.Printf("vulnerable app: %s %s %s\n", app.Vendor, app.Name, app.Version)
	}
}
