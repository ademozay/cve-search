package main

import (
	"fmt"
	"log"
	"os"
)

func main() {
	cveData, err := os.ReadFile("db.json")
	if err != nil {
		log.Fatal(err)
		return
	}

	apps := []Application{ // FIXME: read from file
		{
			Name:    "winrar",
			Vendor:  "rarlab",
			Version: "6.11",
		},
	}

	cve, err := NewCVE(cveData)
	if err != nil {
		log.Fatal(err)
		return
	}

	vulnerableApps := cve.VulnerableApps(apps)
	for _, app := range vulnerableApps {
		fmt.Println(app)
	}
}
