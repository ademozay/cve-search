package cve

import (
	"encoding/json"
)

type CPEMatch struct {
	Vulnerable bool   `json:"vulnerable"`
	CPE23Uri   string `json:"cpe23Uri"`
}

type Node struct {
	Operator string     `json:"operator"`
	CPEMatch []CPEMatch `json:"cpe_match"`
}

type Configurations struct {
	Nodes []Node `json:"nodes"`
}

type CVEDataMeta struct {
	ID string `json:"ID"`
}

type CVEData struct {
	Meta CVEDataMeta `json:"CVE_data_meta"`
}

type CVEItem struct {
	Configurations Configurations `json:"configurations"`
	CVEData        CVEData        `json:"cve"`
}

type CVE struct {
	CVEItems []CVEItem `json:"CVE_Items"`
}

func NewCVE(data []byte) (*CVE, error) {
	var cve CVE
	err := json.Unmarshal(data, &cve)
	if err != nil {
		return nil, err
	}
	return &cve, nil
}
