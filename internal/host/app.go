package host

import "github.com/ademozay/vmetric/internal/cve"

type Application struct {
	Name          string
	NameAliases   []string
	Vendor        string
	VendorAliases []string
	Version       string
}

func (app Application) Is(otherApp cve.VulnerableApp) bool {
	sameVendor := app.VendoredBy(otherApp.Vendor)
	sameName := app.NamedBy(otherApp.Name)
	sameVersion := app.Version == otherApp.Version
	return sameVendor && sameName && sameVersion
}

// Any checks if app is any version of otherApp
func (app Application) Any(otherApp cve.VulnerableApp) bool {
	return app.VendoredBy(otherApp.Vendor) && app.NamedBy(otherApp.Name)
}

func (app Application) VendoredBy(vendor string) bool {
	if app.Vendor == vendor {
		return true
	}

	for _, alias := range app.VendorAliases {
		if alias == vendor {
			return true
		}
	}

	return false
}

func (app Application) NamedBy(name string) bool {
	if app.Name == name {
		return true
	}

	for _, alias := range app.NameAliases {
		if alias == name {
			return true
		}
	}

	return false
}
